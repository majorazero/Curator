(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{166:function(e,n,t){"use strict";var r=t(2),a=t(58);function o(){var e=Object(r.a)(["\n  query Readme(\n    $warriorId: UUID!\n    $levelNumber: Int!\n    $abilitiesLevelNumber: Int\n    $epic: Boolean\n  ) {\n    level(warriorId: $warriorId, number: $levelNumber) {\n      warrior {\n        id\n      }\n      number\n      description\n      tip\n      clue\n      floorMap\n    }\n    warrior(id: $warriorId) {\n      id\n      abilities(levelNumber: $abilitiesLevelNumber, epic: $epic)\n    }\n  }\n"]);return o=function(){return e},e}var l=t.n(a)()(o());n.a=l},169:function(e,n,t){"use strict";var r=t(2),a=t(0),o=t.n(a),l=t(3),i=t(38),c=t(39),u=t(41),s=t(40),f=t(42),m=t(7);function p(){var e=Object(r.a)(["\n  background-color: ",";\n  border-radius: 3px;\n  font-size: 1rem;\n  left: 50%;\n  line-height: normal;\n  padding: 0.25rem;\n  pointer-events: none;\n  position: absolute;\n  top: -0.25rem;\n  transform: translate(-50%, -100%);\n  z-index: 100;\n"]);return p=function(){return e},e}function d(){var e=Object(r.a)(["\n  color: ",";\n  display: inline-block;\n  position: relative;\n"]);return d=function(){return e},e}var v=m.j,b=m.i,h=l.b.span(d(),function(e){return e.color}),g=l.b.span(p(),m.a),E=function(e){function n(){var e,t;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return(t=Object(u.a)(this,(e=Object(s.a)(n)).call.apply(e,[this].concat(a)))).state={showTooltip:!1},t.spaceRef=o.a.createRef(),t.handleTouch=function(e){t.setState({showTooltip:t.spaceRef.current.contains(e.target)})},t.handleMouseEnter=function(){t.setState({showTooltip:!0})},t.handleMouseLeave=function(){t.setState({showTooltip:!1})},t}return Object(f.a)(n,e),Object(c.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("touchstart",this.handleTouch)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("touchstart",this.handleTouch)}},{key:"render",value:function(){var e=this.props,n=e.character,t=e.stairs,r=e.unit,a=r?r.color:t?v:b,l=r?"".concat(r.name," (").concat(r.maxHealth," HP)"):t?"Stairs":null,i=this.state.showTooltip;return o.a.createElement(h,{color:a,innerRef:this.spaceRef,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},i&&l&&o.a.createElement(g,null,l),n)}}]),n}(o.a.Component);function y(){var e=Object(r.a)(["\n  cursor: default;\n  font-size: 2rem;\n  line-height: 1;\n  margin: 0;\n  text-align: center;\n"]);return y=function(){return e},e}var j=l.b.pre(y());n.a=function(e){var n=e.floorMap;return o.a.createElement(j,null,n.map(function(e,n){return o.a.createElement("div",{key:n},e.map(function(e,n){var t=e.character,r=e.unit,a=">"===t;return o.a.createElement(E,{character:t,key:n,stairs:a,unit:r})}))}))}},378:function(e,n,t){"use strict";t.r(n);var r=t(38),a=t(39),o=t(41),l=t(40),i=t(42),c=t(2),u=t(0),s=t.n(u),f=t(3),m=t(169),p=t(7);function d(){var e=Object(c.a)(["\n  color: ",";\n"]);return d=function(){return e},e}function v(){var e=Object(c.a)(["\n  color: ",";\n  font-size: 0.8rem;\n  text-transform: uppercase;\n"]);return v=function(){return e},e}function b(){var e=Object(c.a)(["\n  cursor: default;\n"]);return b=function(){return e},e}var h=f.b.span(b()),g=Object(f.b)(h)(v(),p.i),E=Object(f.b)(h)(d(),function(e){return e.color}),y=function(e){var n=e.turnNumber,t=e.message,r=e.unit;if(n)return s.a.createElement(g,null,"turn ".concat(String(n).padStart(3,"0")));var a=r.color,o=r.name;return s.a.createElement(E,{color:a},o," ",t)};function j(){var e=Object(c.a)(["\n  padding: 0.25rem 0;\n  pointer-events: none;\n  position: relative;\n\n  ",";\n"]);return j=function(){return e},e}function k(){var e=Object(c.a)(["\n  -webkit-overflow-scrolling: touch;\n  height: 100%;\n  list-style: none;\n  margin: 0;\n  overflow-y: auto;\n  padding: 0 2rem;\n\n  & > :last-child {\n    margin-bottom: 2rem;\n  }\n"]);return k=function(){return e},e}var w=f.b.ul(k()),O=f.b.li(j(),function(e){return e.hoverable?"\n          pointer-events: auto;\n\n          &:hover::before {\n            border: 2px solid ".concat(p.j,";\n            bottom: 0;\n            content: '';\n            left: -0.75rem;\n            position: absolute;\n            top: 0;\n          }\n        "):""}),S=function(e){function n(){var e,t;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(t=Object(o.a)(this,(e=Object(l.a)(n)).call.apply(e,[this].concat(i)))).listRef=s.a.createRef(),t.scrollToBottom=function(){t.isAtBottom()&&(t.listRef.current.scrollTop=t.listRef.current.scrollHeight)},t.isAtBottom=function(){var e=t.listRef.current;return e.scrollHeight-e.scrollTop-50<=e.clientHeight},t}return Object(i.a)(n,e),Object(a.a)(n,[{key:"componentDidUpdate",value:function(e){this.props.events.length>e.events.length&&this.scrollToBottom()}},{key:"render",value:function(){var e=this.props,n=e.events,t=e.playing,r=e.onEventSelect,a=!t;return s.a.createElement(w,{innerRef:this.listRef},n.map(function(e,n){return s.a.createElement(O,{hoverable:a,key:n,onMouseEnter:function(){return a&&r(n)},onMouseLeave:function(){return a&&r(null)}},s.a.createElement(y,e))}))}}]),n}(s.a.Component);function x(){var e=Object(c.a)(["\n  animation: "," 0.3s ease;\n  color: ",";\n  cursor: default;\n  display: inline-block;\n  font-weight: 400;\n"]);return x=function(){return e},e}function C(){var e=Object(c.a)(["from {\n    transform: scale3d(1, 1, 1);\n  }\n\n  50% {\n    transform: scale3d(1.5, 1.5, 1.5);\n  }\n\n  to {\n    transform: scale3d(1, 1, 1);\n  }\n"]);return C=function(){return e},e}var N=Object(f.d)(C()),T=f.b.span(x(),N,p.e),I=function(e){var n=e.warriorStatus.health;return s.a.createElement("div",null,s.a.createElement(T,{key:n},"\u2665 ",n))};function M(){var e=Object(c.a)(["\n  background-color: ",";\n  border: none;\n  color: ",";\n  cursor: pointer;\n  height: 3.5rem;\n  outline: none;\n  text-transform: uppercase;\n  width: 100%;\n"]);return M=function(){return e},e}function L(){var e=Object(c.a)(["\n  flex: 1;\n  overflow-y: hidden;\n"]);return L=function(){return e},e}function R(){var e=Object(c.a)(["\n  background: none;\n  border: none;\n  color: inherit;\n  cursor: pointer;\n  font-size: 0.8rem;\n  outline: inherit;\n  text-transform: uppercase;\n"]);return R=function(){return e},e}function D(){var e=Object(c.a)(["\n  align-items: center;\n  display: flex;\n  flex: 1;\n  justify-content: flex-end;\n"]);return D=function(){return e},e}function $(){var e=Object(c.a)(["\n  align-items: center;\n  display: flex;\n"]);return $=function(){return e},e}function A(){var e=Object(c.a)(["\n  margin: 1rem 2rem;\n"]);return A=function(){return e},e}function P(){var e=Object(c.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  min-height: 0;\n  width: 100%;\n"]);return P=function(){return e},e}var B=600,U=f.b.div(P()),q=f.b.div(A()),z=f.b.div($()),H=f.b.div(D()),F=f.b.button(R()),G=f.b.div(L()),W=f.b.button(M(),p.c,p.j),J=function(e){function n(){var e,t;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(t=Object(o.a)(this,(e=Object(l.a)(n)).call.apply(e,[this].concat(i)))).state={selectedStep:null,speed:1,step:0},t.startTicking=function(){t.timerId=setTimeout(t.tick,t.getDelay())},t.tick=function(){t.state.step<t.props.events.length-1?t.setState(function(e){return{step:e.step+1}},function(){t.timerId=setTimeout(t.tick,t.getDelay())}):t.props.onPlaybackEnd()},t.stopTicking=function(){clearInterval(t.timerId)},t.getDelay=function(){var e=t.props.epic?2:1;return B/(t.state.speed*e)},t.handleSkipClick=function(){t.stopTicking(),t.props.onPlaybackEnd()},t.handleFastForwardClick=function(){t.setState(function(e){return{speed:2*e.speed}})},t.handleStepSelect=function(e){t.setState({selectedStep:e})},t}return Object(i.a)(n,e),Object(a.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,n=e.playing,t=e.events;if(n)this.startTicking();else{var r=t.length-1;this.setState({step:r})}}},{key:"componentDidUpdate",value:function(e){var n=this,t=this.props,r=t.playing,a=t.levelNumber,o=t.events,l=a!==e.levelNumber;if(r){var i=!e.playing&&o!==e.events;(i||l)&&this.setState(function(e){var n=e.speed;return{selectedStep:null,speed:i?1:n,step:0}},function(){n.startTicking()})}else if(l){var c=o.length-1;this.setState({step:c})}}},{key:"componentWillUnmount",value:function(){this.stopTicking()}},{key:"render",value:function(){var e=this.props,n=e.events,t=e.playing,r=this.state,a=r.step,o=r.selectedStep,l=r.speed;if(a>n.length)return null;var i=n[null!==o?o:a],c=i.floorMap,u=i.warriorStatus,f=n.slice(0,a+1);return s.a.createElement(U,null,s.a.createElement(q,null,s.a.createElement(z,null,s.a.createElement(I,{warriorStatus:u}),t&&s.a.createElement(H,null,s.a.createElement(F,{onClick:this.handleFastForwardClick},l,"x"))),s.a.createElement(m.a,{floorMap:c})),s.a.createElement(G,null,s.a.createElement(S,{events:f,onEventSelect:this.handleStepSelect,playing:t})),t&&s.a.createElement(W,{onClick:this.handleSkipClick},"Skip"))}}]),n}(s.a.Component);function Y(){var e=Object(c.a)(["\n  padding-left: 2rem;\n  text-align: right;\n"]);return Y=function(){return e},e}function Q(){var e=Object(c.a)(["\n  -webkit-overflow-scrolling: touch;\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n  overflow-y: auto;\n  padding: 0 2rem 2rem;\n  width: 100%;\n"]);return Q=function(){return e},e}var K=f.b.div(Q()),V=f.b.td(Y()),X=function(e){var n=e.score,t=n.warrior,r=n.timeBonus,a=n.clearBonus,o=n.total;return s.a.createElement(K,null,s.a.createElement("table",null,s.a.createElement("tbody",null,s.a.createElement("tr",null,s.a.createElement("td",null,"Warrior Score"),s.a.createElement(V,null,t)),s.a.createElement("tr",null,s.a.createElement("td",null,"Time Bonus"),s.a.createElement(V,null,r)),s.a.createElement("tr",null,s.a.createElement("td",null,"Clear Bonus"),s.a.createElement(V,null,a)),s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement("strong",null,"Total Score")),s.a.createElement(V,null,s.a.createElement("strong",null,o))))))},Z=t(16),_=t.n(Z),ee=t(25),ne=t(43),te=t(166),re=t(58);function ae(){var e=Object(c.a)(["\n  mutation RequestClue($warriorId: UUID!, $levelNumber: Int!) {\n    requestClue(warriorId: $warriorId, levelNumber: $levelNumber) {\n      level {\n        warrior {\n          id\n        }\n        number\n        clue\n      }\n    }\n  }\n"]);return ae=function(){return e},e}var oe=t.n(re)()(ae());function le(){var e=Object(c.a)(["\n  margin: 0;\n"]);return le=function(){return e},e}function ie(){var e=Object(c.a)(["\n  background-color: ",";\n  border-radius: 3px;\n  border: 1px solid ",";\n  color: ",";\n  cursor: pointer;\n  font-size: 0.8rem;\n  line-height: inherit;\n  outline: none;\n  padding: 0.25rem 0.5rem;\n  text-transform: uppercase;\n  transition: background 0.2s ease, color 0.2s ease;\n\n  &:disabled {\n    opacity: 0.4;\n  }\n\n  &:hover:enabled {\n    background-color: ",";\n    color: ",";\n  }\n"]);return ie=function(){return e},e}var ce=f.b.button(ie(),p.j,p.j,p.b,p.b,p.j),ue=f.b.p(le()),se=function(e){function n(){var e,t;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(t=Object(o.a)(this,(e=Object(l.a)(n)).call.apply(e,[this].concat(i)))).state={requested:!1},t.handleClick=function(e){return function(){var n=Object(ee.a)(_.a.mark(function n(r){var a,o,l;return _.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r.preventDefault(),a=t.props,o=a.warriorId,l=a.levelNumber,n.next=4,e({variables:{levelNumber:l,warriorId:o}});case 4:t.setState({requested:!0});case 5:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}()},t}return Object(i.a)(n,e),Object(a.a)(n,[{key:"render",value:function(){var e=this;if(this.state.requested)return s.a.createElement(ue,null,"Check the README for the clues!");var n=this.props,t=n.warriorId,r=n.levelNumber,a=n.epic;return s.a.createElement(ne.Query,{query:te.a,variables:{levelNumber:r,warriorId:t,abilitiesLevelNumber:!a&&r||void 0,epic:a||void 0}},function(n){var t=n.loading,r=n.error,a=n.data;return t||r?null:a.level.clue?null:s.a.createElement(ne.Mutation,{mutation:oe,onCompleted:e.handlePlayData},function(n,t){var r=t.loading;return s.a.createElement(ce,{disabled:r,onClick:e.handleClick(n)},"Request Clue")})})}}]),n}(s.a.Component);function fe(){var e=Object(c.a)(["\n  padding-left: 2rem;\n  text-align: right;\n"]);return fe=function(){return e},e}function me(){var e=Object(c.a)(["\n  -webkit-overflow-scrolling: touch;\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n  overflow-y: auto;\n  padding: 0 2rem 2rem;\n  width: 100%;\n"]);return me=function(){return e},e}var pe=f.b.div(me()),de=f.b.td(fe()),ve=function(e){var n=e.averageGrade,t=e.results,r=e.totalScore;return s.a.createElement(pe,null,s.a.createElement("table",null,s.a.createElement("tbody",null,t.map(function(e,n){var t=e.score;return s.a.createElement("tr",{key:n},s.a.createElement("td",null,"Level ",n+1),s.a.createElement(de,null,t.total),s.a.createElement(de,null,t.grade))}),s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement("strong",null,"Total Score")),s.a.createElement(de,null,s.a.createElement("strong",null,r)),s.a.createElement(de,null,s.a.createElement("strong",null,n))))))};function be(){var e=Object(c.a)(["\n  background-color: ",";\n  color: ",";\n"]);return be=function(){return e},e}function he(){var e=Object(c.a)(["\n  background-color: ",";\n  color: ",";\n"]);return he=function(){return e},e}function ge(){var e=Object(c.a)(["\n  background: none;\n  border: none;\n  color: inherit;\n  cursor: pointer;\n  height: 3.5rem;\n  outline: none;\n  text-transform: uppercase;\n  width: 100%;\n"]);return ge=function(){return e},e}function Ee(){var e=Object(c.a)(["\n  margin: 0 2rem 2rem;\n  opacity: 0.4;\n"]);return Ee=function(){return e},e}function ye(){var e=Object(c.a)(["\n  color: ",";\n"]);return ye=function(){return e},e}function je(){var e=Object(c.a)(["\n  color: ",";\n"]);return je=function(){return e},e}function ke(){var e=Object(c.a)(["\n  font-size: 1.25rem;\n  margin: 1rem 2rem;\n  text-align: center;\n"]);return ke=function(){return e},e}function we(){var e=Object(c.a)(["\n  align-items: center;\n  display: flex;\n  flex: 1;\n  flex-direction: column;\n  justify-content: center;\n  overflow-y: hidden;\n"]);return we=function(){return e},e}function Oe(){var e=Object(c.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  min-height: 0;\n  width: 100%;\n"]);return Oe=function(){return e},e}var Se=f.b.div(Oe()),xe=f.b.div(we()),Ce=f.b.p(ke()),Ne=Object(f.b)(Ce)(je(),p.g),Te=Object(f.b)(Ce)(ye(),p.e),Ie=Object(f.b)(Ce)(Ee()),Me=f.b.button(ge()),Le=Object(f.b)(Me)(he(),p.c,p.j),Re=Object(f.b)(Me)(be(),p.f,p.b),De=function(e){var n=e.levelNumber,t=e.onDismissClick,r=e.onEpicModeClick,a=e.onNextLevelClick,o=e.play,l=o.results[o.epic?n-1:0],i=l.passed,c=l.score;if(i)return o.warrior.levelNumber>n?s.a.createElement(Se,null,s.a.createElement(xe,null,s.a.createElement(Ne,null,"Success! You've found the stairs."),s.a.createElement(X,{score:c})),o.newContent?s.a.createElement(Re,{onClick:function(){return a()}},"Next Level!"):s.a.createElement(Le,{onClick:function(){return t()}},"Dismiss")):s.a.createElement(Se,null,s.a.createElement(xe,null,s.a.createElement(Ne,null,"CONGRATULATIONS! You've climbed to the top of the tower."),o.epic?s.a.createElement(ve,{averageGrade:o.warrior.averageGrade,results:o.results,totalScore:o.warrior.score}):s.a.createElement(X,{score:c})),o.newContent?s.a.createElement(Re,{onClick:function(){return r()}},"Epic Mode!"):s.a.createElement(Le,{onClick:function(){return t()}},"Dismiss"));var u=o.epic,f=o.warrior.id;return s.a.createElement(Se,null,s.a.createElement(xe,null,s.a.createElement(Te,null,"Sorry, you've failed this level."),s.a.createElement(Ie,null,"Change your script and try again."),s.a.createElement(se,{epic:u,levelNumber:n,warriorId:f})),s.a.createElement(Le,{onClick:function(){return t()}},"Dismiss"))};function $e(){var e=Object(c.a)(["\n  font-size: 1.25rem;\n  opacity: 0.4;\n  text-align: center;\n"]);return $e=function(){return e},e}function Ae(){var e=Object(c.a)(["\n  align-items: center;\n  display: flex;\n  height: 100%;\n  justify-content: center;\n  padding: 2rem;\n  width: 100%;\n"]);return Ae=function(){return e},e}var Pe=f.b.div(Ae()),Be=f.b.p($e()),Ue=function(e){function n(){var e,t;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(t=Object(o.a)(this,(e=Object(l.a)(n)).call.apply(e,[this].concat(i)))).state={showSummary:!1},t.getLevelResult=function(){var e=t.props,n=e.play,r=e.epic,a=e.levelNumber;return!n||n.epic&&!r||!n.epic&&n.levelNumber!==a?null:n.results[n.epic?a-1:0]},t.handlePlaybackEnd=function(){var e=t.props,n=e.play,r=e.levelNumber,a=e.goToNextLevel;n.epic&&r<n.results.length?a():t.setState({showSummary:!0})},t.handleDismissClick=function(){t.props.onPlayEnd(!1),t.setState({showSummary:!1})},t.handleNextLevelClick=function(){t.props.goToNextLevel(),t.props.onPlayEnd(!0),t.setState({showSummary:!1})},t.handleEpicModeClick=function(){t.props.goToEpicMode(),t.props.onPlayEnd(!0),t.setState({showSummary:!1})},t}return Object(i.a)(n,e),Object(a.a)(n,[{key:"render",value:function(){var e=this.getLevelResult();if(!e)return s.a.createElement(Pe,null,s.a.createElement(Be,null,"Hit the Run button to watch your warrior in action here"));var n=this.props,t=n.levelNumber,r=n.play,a=n.playing;if(this.state.showSummary)return s.a.createElement(De,{levelNumber:t,onDismissClick:this.handleDismissClick,onEpicModeClick:this.handleEpicModeClick,onNextLevelClick:this.handleNextLevelClick,play:r});var o=e.events;return s.a.createElement(J,{epic:r.epic,levelNumber:t,onPlaybackEnd:this.handlePlaybackEnd,events:o,playing:a})}}]),n}(s.a.Component);n.default=Ue}}]);
//# sourceMappingURL=play.12bf6b82.chunk.js.map